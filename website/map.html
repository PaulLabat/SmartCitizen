<!DOCTYPE html>
<html>
<head>
  <title>SmartCitizen</title>
  <meta charset="utf-8" />   
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <meta name="author" content="Paul Labat">

  <!--perso-->
  <link href="css/style.css" rel="stylesheet">
  <!--prototype.js -->
  <script src="js/prototype.js"></script>
  <!--jquery-->
  <script src="js/jquery.min.js"></script>
  <!--bootstrap-->
  <script src="bootstrap/js/bootstrap.min.js"></script>
  <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- leaflet-->
  <link href="leaflet/leaflet.css" rel="stylesheet">
  <script src="leaflet/leaflet.js"></script>
  <style type="text/css">
    .leaflet-popup-content-wrapper { background-color: grey; }
  </style>

  <!--socket.io-->
  <script type="text/javascript" src="js/socket.io.min.js"></script>
</head>
<body>
    
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">SmartCitizen</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="index.html">Home</a></li>
            <li class="active"><a href="map.html">Map</a></li>
            <li><a href="about.html">About</a></li>
          </ul>
        </div>
      </div>
    </div>


    <div id="map"></div>
    


    
    <!--Beggining of the script for the map -->
  <script>
  jQuery.noConflict();

//--------------------define the map
  var map = L.map('map').setView([45.18, 5.75], 12);

    L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
            maxZoom:18
    }).addTo(map);

//-------------------socket
  var socket = io.connect('http://localhost:3000');//connection on the socket port number 3000
  
  socket.on('connect', function(){// when a connect message is emitted from the server
    console.log("socketio", "connected");

    socket.on('queryResponse', function(msg){ // when a mqqt message is emitted from the server
      console.log('queryResponse', msg);
    });


    socket.emit('startQuery', {'idKey' :'5945cda8-fb4c-4a5a-a710-3289a9b4d95c'});//send to the server which query to proceed, is executed once-
  });    

  </script>
</body>
</html
